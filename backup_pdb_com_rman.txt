========================================================================================
== Backup de PDB com RMAN
== Marcio Mandarino
== 09 de setembro de 2025
== marcio@mrdba.com.br
== www.mrdba.com.br
== https://www.linkedin.com/in/marciomandarino/
========================================================================================

=================================================================
== ğŸ¯ Resumo do vÃ­deo:
=================================================================
ğŸ“ SequÃªncia
ğŸ“ VisÃ£o Geral
ğŸ“ Backup FULL do PDB
ğŸ“ Backup INCREMENTAL do PDB
ğŸ“ Backup com paralelismo
ğŸ“ Backup com compressÃ£o
ğŸ“ Backup de dois PDBs simultaneamente
ğŸ“ Backup com TAG
ğŸ“ Verificando os backups
ğŸ“ Limpa tudo
ğŸ“ ConclusÃ£o


=================================================================
== ğŸ¯ SequÃªncia
=================================================================
ğŸ› ï¸ Backup de PDB com RMAN
â³ Restaurando um arquivo de dados do PDB
â³ Restaurando o PDB inteiro
â³ Restaurando um PDB excluÃ­do


=================================================================
== ğŸ¯ VisÃ£o Geral
=================================================================
â–¶ï¸ Com o RMAN, Ã© possÃ­vel gerar backups de cada PDB individualmente
â–¶ï¸ Este recurso permite flexibilidade para suas operaÃ§Ãµes de backup
  â–«ï¸ Fazer backups de PDBs especÃ­ficos
  â–«ï¸ ReduÃ§Ã£o do tempo de backup
  â–«ï¸ Gerenciamento de recursos
  â–«ï¸ Flexibilidade e controle


=================================================================
== ğŸ¯ Backup FULL do PDB
=================================================================
-- Backup FULL (nÃ£o incremental) de um PDB especÃ­fico
RMAN> BACKUP PLUGGABLE DATABASE pdb1;


=================================================================
== ğŸ¯ Backup INCREMENTAL do PDB
=================================================================
-- Level 0: estabelece a base para backups level 1 subsequentes
RMAN> BACKUP INCREMENTAL LEVEL 0 PLUGGABLE DATABASE pdb1;

-- Level 1 DIFFERENTIAL: copia blocos alterados desde o Ãºltimo level 1 ou level 0
RMAN> BACKUP INCREMENTAL LEVEL 1 DIFFERENTIAL PLUGGABLE DATABASE pdb1;

-- Level 1 CUMULATIVE: copia blocos alterados desde o Ãºltimo level 0
RMAN> BACKUP INCREMENTAL LEVEL 1 CUMULATIVE PLUGGABLE DATABASE pdb1;


=================================================================
== ğŸ¯ Backup com paralelismo
=================================================================
-- Paralelismo (alocando canais manualmente)
RMAN> RUN {
  ALLOCATE CHANNEL ch1 DEVICE TYPE DISK;
  ALLOCATE CHANNEL ch2 DEVICE TYPE DISK;
  BACKUP PLUGGABLE DATABASE pdb1;
  RELEASE CHANNEL ch1;
  RELEASE CHANNEL ch2;
}


=================================================================
== ğŸ¯ Backup com compressÃ£o
=================================================================
RMAN> BACKUP AS COMPRESSED BACKUPSET PLUGGABLE DATABASE pdb1;


=================================================================
== ğŸ¯ Backup de dois PDBs simultaneamente
=================================================================
RMAN> BACKUP PLUGGABLE DATABASE pdb1, pdb2;


=================================================================
== ğŸ¯ Backup com TAG
=================================================================
RMAN> BACKUP PLUGGABLE DATABASE pdb1 TAG 'BKP_FULL_PDB1';


=================================================================
== ğŸ¯ Verificando os backups
=================================================================
-- Listar backups do PDB
RMAN> LIST BACKUP OF PLUGGABLE DATABASE pdb1;

-- Listar backups por TAG (ex.: BKP_FULL_PDB1)
RMAN> LIST BACKUP TAG 'BKP_FULL_PDB1';


=================================================================
== ğŸ§¹ Limpa tudo
=================================================================
-- Remover backups do PDB
RMAN> DELETE NOPROMPT BACKUP OF PLUGGABLE DATABASE pdb1;

-- Remover backups por TAG
RMAN> DELETE NOPROMPT BACKUP TAG 'BKP_FULL_PDB1';

-- Remover backups obsoletos
RMAN> DELETE NOPROMPT OBSOLETE;


=================================================================
== ğŸ ConclusÃ£o
=================================================================
â–¶ï¸ Saber executar backups de PDBs individualmente Ã© muito Ãºtil
â–¶ï¸ O mais importante Ã© vocÃª entender em quais situaÃ§Ãµes vocÃª pode aplicar esse recurso
ğŸ’¡ Pratique, repita e repita mais uma vez. Quando estiver cansado, descanse e pratique mais uma vez
