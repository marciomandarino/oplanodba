========================================================================================
== ParÃ¢metros no Oracle â€“ SPFILE e PFILE
== Marcio Mandarino
== 07 de agosto de 2025
== marcio@mrdba.com.br
== www.mrdba.com.br
== https://www.linkedin.com/in/marciomandarino/
========================================================================================

=================================================================
== ğŸ¯ Resumo do vÃ­deo:
=================================================================
ğŸ“ Finalidade do arquivo de inicializaÃ§Ã£o  
ğŸ“ DiferenÃ§as entre SPFILE e PFILE  
ğŸ“ SPFILE como padrÃ£o de produÃ§Ã£o  
ğŸ“ Casos especÃ­ficos para uso de PFILE  
ğŸ“ Exemplos de STARTUP com SPFILE e PFILE  
ğŸ“ Exibindo o parÃ¢metro spfile  


=================================================================
== ğŸ¯ ConteÃºdo relacionado
=================================================================
ğŸ’¡ DiferenÃ§a entre spfile e pfile
ğŸ’¡ ParaÌ‚metros EstaÌticos vs DinaÌ‚micos no Oracle
ğŸ’¡ Backup e Restore do arquivo de parÃ¢metro


=================================================================
== ğŸ¯ VisÃ£o Geral
=================================================================
â–¶ï¸ O arquivo de inicializaÃ§Ã£o carrega parÃ¢metros que definem o comportamento do Oracle Database  
â–¶ï¸ Ã‰ lido durante o estÃ¡gio NOMOUNT para configurar memÃ³ria, processos, paths e opÃ§Ãµes diversas  
â–¶ï¸ Existem dois tipos de arquivo: 
   â–«ï¸ PFILE (texto) 
   â–«ï¸ SPFILE (binÃ¡rio gerenciado pelo servidor)  
â–¶ï¸ A partir do Oracle 9i, o SPFILE tornou-se o padrÃ£o recomendado em produÃ§Ã£o  
â–¶ï¸ O PFILE sÃ³ deve ser usado em situaÃ§Ãµes especÃ­ficas  
â–¶ï¸ Normalmente, ficam armazenados no diretÃ³rio $ORACLE_HOME/dbs/
*

=================================================================
== ğŸ¯ Vantagens do spfile
=================================================================
ğŸ’¡ Permite mudar parÃ¢metros com ALTER SYSTEM sem reiniciar o banco.
ğŸ’¡ Salva as mudanÃ§as automaticamente no arquivo binÃ¡rio, mantendo-as apÃ³s reinÃ­cios.
ğŸ’¡ Dispensa ediÃ§Ã£o manual, reduzindo risco de erros.
ğŸ’¡ Em RAC, um Ãºnico SPFILE Ã© usado por todas as instÃ¢ncias.
ğŸ’¡ Mais seguro: formato binÃ¡rio evita alteraÃ§Ãµes acidentais.
ğŸ’¡ Funciona com RMAN e OEM para backup/restauraÃ§Ã£o automÃ¡ticos.
ğŸ’¡ Ã‰ carregado automaticamente pela instÃ¢ncia, sem precisar indicar caminho.



=================================================================
== ğŸ¯ UtilizaÃ§Ã£o do SPFILE
=================================================================
â–¶ï¸ SPFILE Ã© o padrÃ£o
â–¶ï¸ o SPFILE utilizado Ã© definido pelo parÃ¢metro inicilizaÃ§Ã£o spfile
â–¶ï¸ STARTUP usando o SPFILE padrÃ£o:
SQL> STARTUP;

SQL> SHOW PARAMETER spfile;
NAME                                 TYPE        VALUE
------------------------------------ ----------- -----------------------------------------------------
spfile                               string      /u01/app/oracle/product/19c/db_1/dbs/spfilecdb1.ora
                                                 

$ sqlplus / as sysdba
SQL> shutdown immediate;
SQL> startup nomount 
SQL> SHOW PARAMETER spfile;
SQL> exit

$ mv /u01/app/oracle/product/19c/db_1/dbs/spfilecdb1.ora /u01/app/oracle/product/19c/db_1/dbs/spfilecdb1.ora2
$ sqlplus / as sysdba
SQL> shutdown immediate;
SQL> startup nomount;
SQL> !mv /u01/app/oracle/product/19c/db_1/dbs/spfilecdb1.ora2 /u01/app/oracle/product/19c/db_1/dbs/spfilecdb1.ora
SQL> startup nomount;
SQ> ALTER SYSTEM SET db_recovery_file_dest_size = 10G SCOPE=BOTH;
SQL> exit;
$ cat /u01/app/oracle/product/19c/db_1/dbs/spfilecdb1.ora


=================================================================
== ğŸ¯ UtilizaÃ§Ã£o do PFILE
=================================================================

$ sqlplus / as sysdba
SQL> create pfile='/tmp/init.ora' from spfile;
SQL> shutdown immediate;
SQL> startup nomount pfile='/tmp/init.ora';
SQL> ALTER SYSTEM SET db_recovery_file_dest_size = 10G SCOPE=BOTH;
ALTER SYSTEM SET db_recovery_file_dest_size = 10G SCOPE=BOTH
*
ERROR at line 1:
ORA-32001: write to SPFILE requested but no SPFILE is in use

SQL> EXIT

$ vi /tmp/init.ora

$ sqlplus / as sysdba
SQL> shutdown immediate;
SQL> startup nomount pfile='/tmp/init.ora';
SQL> show parameter db_recovery_file_dest_size
SQL> show parameter spfile;
SQL> shutdown immediate;
SQL> startup;

   
=================================================================
== ğŸ ConclusÃ£o
=================================================================
â–¶ï¸ SPFILE Ã© o mÃ©todo padrÃ£o e recomendado  
â–¶ï¸ PFILE sÃ³ deve ser usado em situaÃ§Ãµes de emergÃªncia ou para testes isolados  
â–¶ï¸ Ã‰ importante entender como e quando usar cada arquivo
